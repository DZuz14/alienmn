<!-- Generated by SpecStory -->

# Propose component breakdown strategy (2025-07-13 16:42Z)

_**User (2025-07-16 21:22Z)**_

This component has a lot of jsx. give me a proposal to break down some pieces into their own component, dont do it yet

---

_**Assistant**_

Looking at the `Lyrics` component in `song.tsx`, I can propose several ways to break it down into smaller, more manageable components:

1. **AnnotationTooltip Component**:
   - Extract the annotation tooltip popup into its own component
   - Would handle the display and positioning of annotations
   - Receive props like `annotation` and `onClose`

2. **LyricLine Component**:
   - Extract the individual lyric line rendering
   - Handle the click events and styling for annotations
   - Receive props like `line`, `onAnnotationClick`

3. **ViewModeToggle Component**:
   - Extract the view mode toggle buttons
   - Handle the switching between original and DIY modes
   - Receive props like `viewMode`, `setViewMode`

4. **SongHeader Component**:
   - Extract the title and header section
   - Receive props like `title`

This breakdown would make the main component more readable, improve reusability, and make future maintenance easier. Each component would have a clear, single responsibility.

---

_**User (2025-07-16 21:22Z)**_

songs good. I want them in the same file at the bottom. List them in order as they appear in the jsx. Use jsdoc multiline comments and use props.something comment styling for props

---

_**Assistant**_

I'll create the component definitions at the bottom of the file in the order they appear in the JSX, with JSDoc comments and props.something notation. Here's how I'll structure them:

---

<details><summary>Edit file: src/app/lyrics/song.tsx</summary>

I'll add component definitions at the bottom of the file in the order they appear in the JSX, with JSDoc comments and props notation.

**Chunk 1**
Lines added: undefined, lines removed: 5

```diff
@@ -12,9 +12,4 @@
    const { title, lyrics } = alienman;
  
-   /**
-    * Handles the click event for a lyric.
-    * @param annotation - The annotation to display.
-    * @param event - The click event.
-    */
    const handleLyricClick = (
      annotation: string | undefined,
```

**Chunk 2**
Lines added: 56, lines removed: 1

```diff
@@ -37,8 +32,63 @@
    return (
      <div className="min-h-screen bg-gradient-to-br from-violet-600 via-indigo-900 to-gray-900 p-8">
+       <SongHeader title={title} />
+ 
+       <ViewModeToggle viewMode={viewMode} setViewMode={setViewMode} />
+ 
+       <div className="bg-gray-100 rounded-lg p-6 max-w-2xl mx-auto relative">
+         {viewMode === 'original' && (
+           <p className="text-gray-400 italic text-sm mb-4">
+             Dotted underlines indicate additional context about the lyrics
+           </p>
+         )}
+         <div className="text-gray-800 space-y-4">
+           {/* @ts-ignore */}
+           {lyrics[viewMode].map((line: Lyric, index: number) => (
+             <LyricLine 
+               key={index} 
+               line={line} 
+               onAnnotationClick={handleLyricClick} 
+             />
+           ))}
+         </div>
+ 
+         {activeAnnotation && (
+           <AnnotationTooltip 
+             annotation={activeAnnotation} 
+             onClose={() => setActiveAnnotation(null)} 
+           />
+         )}
+       </div>
+     </div>
+   );
+ }
+ 
+ /**
+  * Displays the song title header
+  * @param {Object} props
+  * @param {string} props.title - The title of the song
+  */
+ function SongHeader({ title }: { title: string }) {
+   return (
      <h1 className="text-4xl font-bold text-white text-center mt-8 mb-8">
        {title}
      </h1>
- 
+   );
+ }
+ 
+ /**
+  * Toggle buttons to switch between original and DIY view modes
+  * @param {Object} props
+  * @param {'original' | 'diy'} props.viewMode - Current view mode
+  * @param {Function} props.setViewMode - Function to update the view mode
+  */
+ function ViewModeToggle({ 
+   viewMode, 
+   setViewMode 
+ }: { 
+   viewMode: 'original' | 'diy'; 
+   setViewMode: (mode: 'original' | 'diy') => void;
+ }) {
+   return (
      <div className="flex justify-center gap-6 mb-8">
        <button
```

**Chunk 3**
Lines added: 19, lines removed: 18

```diff
@@ -59,22 +109,23 @@
        </button>
      </div>
- 
-       <div className="bg-gray-100 rounded-lg p-6 max-w-2xl mx-auto relative">
-         {viewMode === 'original' && (
-           <p className="text-gray-400 italic text-sm mb-4">
-             Dotted underlines indicate additional context about the lyrics
-           </p>
-         )}
-         <div className="text-gray-800 space-y-4">
-           {/* @ts-ignore */}
-           {lyrics[viewMode].map((line: Lyric, index: number) => (
-             <p
-               key={index}
-               onClick={(e) =>
-                 handleLyricClick(
-                   line.annotation ? line.annotation : undefined,
-                   e
-                 )
-               }
+   );
+ }
+ 
+ /**
+  * Renders a single line of lyrics with optional annotation
+  * @param {Object} props
+  * @param {Lyric} props.line - The lyric line object containing text and optional annotation
+  * @param {Function} props.onAnnotationClick - Handler for when an annotated lyric is clicked
+  */
+ function LyricLine({ 
+   line, 
+   onAnnotationClick 
+ }: { 
+   line: Lyric; 
+   onAnnotationClick: (annotation: string | undefined, event: MouseEvent<HTMLParagraphElement>) => void;
+ }) {
+   return (
+     <p
+       onClick={(e) => onAnnotationClick(line.annotation ? line.annotation : undefined, e)}
        className={`${
          line.annotation
```

**Chunk 4**
Lines added: 22, lines removed: 12

```diff
@@ -85,22 +136,32 @@
        {line.text}
      </p>
-           ))}
-         </div>
- 
-         {activeAnnotation && (
+   );
+ }
+ 
+ /**
+  * Displays an annotation tooltip at the specified position
+  * @param {Object} props
+  * @param {Annotation} props.annotation - The annotation object with text and position
+  * @param {Function} props.onClose - Handler for closing the annotation
+  */
+ function AnnotationTooltip({ 
+   annotation, 
+   onClose 
+ }: { 
+   annotation: Annotation; 
+   onClose: () => void;
+ }) {
+   return (
      <div
        className="fixed bg-gray-800 text-white p-3 rounded-lg text-sm max-w-xs shadow-lg transition-opacity duration-200"
        style={{
-               top: activeAnnotation.position.top,
-               left: activeAnnotation.position.left,
-               transform: activeAnnotation.position.transform,
+         top: annotation.position.top,
+         left: annotation.position.left,
+         transform: annotation.position.transform,
        }}
-             onClick={() => setActiveAnnotation(null)}
+       onClick={onClose}
      >
-             {activeAnnotation.text}
+       {annotation.text}
        <div className="absolute left-1/2 bottom-0 w-2 h-2 bg-gray-800 transform rotate-45 translate-y-1/2 -translate-x-1/2"></div>
-           </div>
-         )}
-       </div>
      </div>
    );
```

</details>

---

_**User (2025-07-16 21:22Z)**_

add a js multi at the topic that links to each component in order to prevent scrolling

---

_**Assistant**_

Cancelled

---

